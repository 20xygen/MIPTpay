{% extends 'material_base.html' %}
{% block title %}Chats{% endblock %}
{% block header %}Chats{% endblock %}
{% block enable_logo %}{% endblock %}
{% block enable1 %}{% endblock %}
{% block enable2 %}{% endblock %}
{% block enable3 %}{% endblock %}
{% block enable_chats %}active{% endblock %}
{% block enable4 %}{% endblock %}
{% block enable5 %}{% endblock %}
{% block enable6 %}{% endblock %}
{% block enable7 %}{% endblock %}
{% block enable8 %}{% endblock %}
{% block enable9 %}{% endblock %}
{% block content %}

  <div class="chats-wrapper">
    <section class="chats-discussions">
      <form method="post" class="chats-search-wrapper">
        {% csrf_token %}
        <div class="chats-searchbar">
          <input type="text" name="chat" placeholder="Search..."></input>
          <button type="submit">
            <i class='bx bx-search scaled-button'></i>
          </button>
        </div>
      </form>

      {% for sender, last, is_active, number in discussions %}
        <a href="/chats/?conversation={{ number }}" class="chats-discussion {% if is_active %}chats-message-active{% else %}{% endif %}">
          <div class="chats-photo" style="background-image: url(https://sun9-38.userapi.com/impg/06YaBsA5s8i3dh7aLhPsEY1TeaS_qQ9JmkzWkw/qjKdUtuB3rY.jpg?size=800x800&quality=95&sign=e1f4b0faffe37006fb2b2e5450792926&type=album);"></div>
          <div class="chats-desc-contact">
            <p class="chats-name">{{ sender.name }}</p>
            <p class="chats-message">{% if last %}{{ last.sender.name }}: {{ last.text }}{% else %}{% endif %}</p>
          </div>
        </a>
      {% endfor %}
    </section>

    <section class="chats-chat">
      <div class="chats-header-chat">
        <i class="chats-icon fa fa-user-o" aria-hidden="true"></i>
        <p class="chats-name">{% if other %}{{ other.name }}{% else %}Choose chat{% endif %}</p>
        <i class="chats-icon clickable fa fa-ellipsis-h right" aria-hidden="true"></i>
      </div>
      <div class="chats-messages-chat">
        {% for message in messages %}
          {% if message.sender == me %}
            <div class="chats-message text-only">
              <div class="chats-response">
                <p class="chats-text"> {{ message.text }} </p>
              </div>
            </div>
          {% else %}
            <div class="chats-message">
              <p class="chats-text"> {{ message.text }} </p>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      <form method="post" class="chats-footer-chat">
        {% csrf_token %}
        <div class="chats-search-wrapper">
          <div class="chats-sender">
            <input type="text" name="text" placeholder="Type..."/>
            <button type="submit">
              <i class='bx bx-paper-plane scaled-sender-button'></i>
            </button>
          </div>
        </div>
      </form>

    </section>
  </div>
{% endblock %}
